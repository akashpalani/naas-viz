#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(str_sub(Q7_1, 5))) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mlevels() %>%
mutate(Q7_1 = fct_recode(Q7_1,
"Don't think in terms of parties" = ""))
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
levels() %>%
mutate(Q7_1 = fct_recode(Q7_1,
"Don't think in terms of parties" = ""))
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
levels(Q7_1)
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
levels(Q7_1)
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
levels(o$Q7_1)
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
levels(o$Q7_1)
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused"))
levels(o$Q7_1)
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1))
levels(o$Q7_1)
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"Other party" = "(04) Other party  SPECIFY"))
o <- ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"Other party" = "(04) Other party  SPECIFY")) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"Other party" = "(04) Other party  SPECIFY")) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5))
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~S7) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party affiliation by ethnicity and birthplace
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~FORBORN) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~EDUC3) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_grid(~EDUC3) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_grid(~EDUC3, rows = 2, cols = 2) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = EDUC3, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party affiliation by ethnicity and birthplace
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = FORBORN, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party affiliation by ethnicity and Gender
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = S7, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = EDUC3, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
ethnicity_stacked_bar(ethnicity_data$ethnicity, ethnicity_data$S7, "Ethnicity", "Count", "Gender")
#Healthcare followup: How would you rate your overall health in the past year?
ethnicity_data %>%
mutate(Q8_8 = as.character(Q8_8)) %>%
#According to the codebook, random sample of half of respondents were surveyed, so drop missing values and understand that this is only half of the respondents.
drop_na(Q8_8) %>%
mutate(Q8_8 = as.factor(str_sub(Q8_8, 5))) %>%
ggplot(aes(x = ethnicity, fill = Q8_8)) +
geom_bar(position = "fill") +
ggtitle("Healthcare: Rate your overall health in the past year") +
labs(fill = "Response") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Healthcare followup: How would you rate your overall health in the past year?
ethnicity_data %>%
mutate(Q8_8 = as.character(Q8_8)) %>%
#According to the codebook, random sample of half of respondents were surveyed, so drop missing values and understand that this is only half of the respondents.
drop_na(Q8_8) %>%
mutate(Q8_8 = as.factor(str_sub(Q8_8, 5))) %>%
ggplot(aes(x = ethnicity, fill = Q8_8)) +
geom_bar(position = "fill", alpha = 0.9) +
ggtitle("Healthcare: Rate your overall health in the past year") +
labs(fill = "Response") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Education: Federal Student Loan Relief
ethnicity_data %>%
mutate(Q6_5_2 = as.character(Q6_5_2)) %>%
#According to the codebook, NA means don't know/refused
replace_na(list(Q6_5_2 = "(3) Don't Know/Refused")) %>%
mutate(Q6_5_2 = as.factor(str_sub(Q6_5_2, 5))) %>%
ggplot(aes(x = ethnicity, fill = Q6_5_2)) +
geom_bar(position = "fill") +
ggtitle("Education: Federal Student Loan Relief") +
labs(fill = "Position") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Race: Government Promotion of Black-White Equality
ethnicity_data %>%
mutate(Q6_5_7 = as.character(Q6_5_7)) %>%
#According to the codebook, NA means don't know/refused
replace_na(list(Q6_5_7 = "(3) Don't Know/Refused")) %>%
mutate(Q6_5_7 = as.factor(str_sub(Q6_5_7, 5))) %>%
ggplot(aes(x = ethnicity, fill = Q6_5_7)) +
geom_bar(position = "fill") +
ggtitle("Race: Government Promotion of Black-White Equality") +
labs(fill = "Position") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
# Party Affiliation -------------------------------------------------------
#Heat map expressing covariation between personal party identification and ethnicity
ethnicity_data %>%
count(ethnicity, Q7_4A) %>%
drop_na(Q7_4A) %>%
mutate(Q7_4A = fct_recode(Q7_4A,
"(2) Closer to neither party" = "(3) Closer to neither party",
"(3) Closer to the Democratic party" = "(2) Closer to the Democratic party")) %>%
ggplot(mapping = aes(y = ethnicity, x = Q7_4A)) +
geom_tile(mapping = aes(fill = n)) +
scale_fill_continuous(high = "#132B43", low = "#56B1F7")
# Party Affiliation -------------------------------------------------------
#Heat map expressing covariation between personal party identification and ethnicity
ethnicity_data %>%
count(ethnicity, Q7_4A) %>%
drop_na(Q7_4A) %>%
mutate(Q7_4A = fct_recode(Q7_4A,
"(2) Closer to neither party" = "(3) Closer to neither party",
"(3) Closer to the Democratic party" = "(2) Closer to the Democratic party")) %>%
ggplot(mapping = aes(y = ethnicity, x = Q7_4A)) +
geom_tile(mapping = aes(fill = n)) +
scale_fill_continuous(high = "#132B43", low = "#56B1F7") +
ggtitle("Covariation: Party Affiliation and Ethnicity")
#Party Affiliation by Ethnicity
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = ethnicity, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party affiliation by ethnicity and Gender
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = S7, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party affiliation by ethnicity and Gender
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = S7, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation by Ethnicity and Gender") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party affiliation by ethnicity and birthplace
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = FORBORN, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation by Ethnicity and Birthplace") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = EDUC3, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = EDUC3, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation by Level of Education and Ethnicity") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
#Clean and replot:
ethnicity_data %>%
mutate(Q6_1D = as.character(Q6_1D)) %>%
mutate(Q6_1D = fct_recode(Q6_1D,
"Taxes" = "(12) ASLDF",
"(88) Other" = "(16) OTHQ6_1C:",
"(88) Other" = "(15) OTHQ6_1B:",
"(88) Other" = "(14) OTHQ6_1A:",
"(88) Other" = "(17) Other  SPECIFY")) %>%
mutate(Q6_1D = as.factor(str_sub(Q6_1D, 5))) %>%
count(Q6_1D = factor(Q6_1D)) %>%
mutate(pct = prop.table(n)) %>%
drop_na(Q6_1D) %>%
ggplot(aes(x = Q6_1D, y = pct, label = scales::percent(pct))) +
geom_col(fill = "blue") +
xlab("Issues") +
ylab("Percentage") +
coord_flip() +
scale_y_continuous(labels = scales::percent)
knitr::opts_chunk$set(echo = TRUE)
plot(pressure)
```{r packages, results=hide}
# Geographic Distribution -----------------------------------------------------------
#Rename data. Copy made to preserve original data in case something goes wrong.
owo <- load(file = "data.rda")
owo
load("/Users/akashpalani/Data Science/Final_Project/data.rda")
# Geographic Distribution -----------------------------------------------------------
#Rename data. Copy made to preserve original data in case something goes wrong.
owo <- load("data.rda")
owo
# Geographic Distribution -----------------------------------------------------------
#Rename data. Copy made to preserve original data in case something goes wrong.
owo <- readRDS("data.rda")
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE, results="hide")
#Rename data. Copy made to preserve original data in case something goes wrong.
load("data.rda")
#Party Affiliation by level of education
ethnicity_data %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
#codebook
replace_na(list(Q7_1 = "(88) Don't Know/Refused")) %>%
mutate(Q7_1 = as.factor(Q7_1)) %>%
mutate(Q7_1 = fct_recode(Q7_1,
"(05) Don't think in terms of parties" = "(05) DO NOT READ  Do not think in terms of political parties",
"(04) Other party" = "(04) Other party  SPECIFY")) %>%
mutate(Q7_1 = as.character(Q7_1)) %>%
mutate(Q7_1 = str_sub(Q7_1, 5)) %>%
ggplot(aes(x = EDUC3, fill = Q7_1)) +
geom_bar(position = "fill", alpha = 0.8) +
#facet by ethnicity so we can look at variation between levels of education within each group
facet_wrap(~ethnicity) +
labs(fill = "Response") +
ggtitle("Party Affiliation by Level of Education and Ethnicity") +
scale_y_continuous(name = "Percentage", labels = scales::percent) +
coord_flip()
